# Interspeech 2026 TOPI S2ST Challenge: R-APM

**检索增强的语用映射器用于跨语言韵律迁移**

[English](README.md) | [日本語](README.ja.md)

---

## 概述

R-APM 是一个基于检索的跨语言韵律迁移系统，从英语 HuBERT 特征（1024维）预测西班牙语韵律特征（101维），采用混合检索+融合架构。

> **📄 系统描述**: [R-APM: Retrieval-Augmented Pragmatic Mapper for Cross-Lingual Prosody Transfer.PDF](docs/R-APM_System_Description.pdf) (即将发布)

## 主要结果

### 内部分割 (官方训练/测试划分)

| 模型 | 分数 | vs MLP Baseline |
|-------|-------|-----------------|
| **1024-Fusion** (提交模型) | **0.8742** | **+0.10%** |
| 1024-Pure | 0.8722 | -0.11% |
| 103-Fusion | 0.8654 | -0.90% |
| 103-Pure | 0.8642 | -1.03% |
| **MLP Baseline** | 0.8732 | - |

### 官方测试集

| 模型 | 分数 | vs MLP Baseline |
|-------|-------|-----------------|
| **1024-Fusion** (提交模型) | **0.8288** | **-2.86%** |
| **MLP Baseline** | **0.8574** | - |

> **注意**: 内部分割使用 `official_baseline/data/filelists/` 中的官方训练/测试文件列表。MLP baseline 在官方测试集上表现优于我们的系统，这表明在对未见说话人的泛化方面存在挑战。

## 架构

### 纯检索模式 (Pure Retrieval)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              纯检索模式 (Pure)                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   输入: EN_1024 (英语 HuBERT 特征, 1024维)                                  │
│       │                                                                     │
│       ▼                                                                     │
│   ┌─────────────────────────────────────────────────────────────┐          │
│   │         增强检索模块                                        │          │
│   │  • 相似度: 余弦相似度                                       │          │
│   │  • Top-K 检索: K=70                                         │          │
│   │  • 温度参数: 0.04 (锐化注意力)                              │          │
│   └─────────────────────────────────────────────────────────────┘          │
│       │                                                                     │
│       ▼                                                                     │
│   ES_retrieved_1024 (检索到的西班牙语特征, 1024维)                          │
│       │                                                                     │
│       ▼                                                                     │
│   ┌─────────────────────────────────────────────────────────────┐          │
│   │         特征选择模块                                        │          │
│   │  • 方法: 官方预定义索引 (101维)                             │          │
│   │  • 来源: 竞赛基线特征选择                                   │          │
│   └─────────────────────────────────────────────────────────────┘          │
│       │                                                                     │
│       ▼                                                                     │
│   输出: ES_101 (西班牙语韵律特征, 101维)                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 融合模式 (Fusion Mode) ⭐ **提交模型**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           融合模式 (Fusion) - 提交模型                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   输入: EN_1024 (英语 HuBERT 特征, 1024维)                                  │
│       │                                                                     │
│       ├────────────────────────────────────────┐                            │
│       ▼                                        ▼                            │
│   ┌─────────────────────┐         ┌─────────────────────────┐             │
│   │   增强检索          │         │   直接投影               │             │
│   │ • Top-K=70          │         │   EN_1024 → 101         │             │
│   │ • Temp=0.04         │         └─────────────────────────┘             │
│   └─────────────────────┘                    │                             │
│       │                                      │                             │
│       ▼                                      │                             │
│   ES_retrieved_1024                          │                             │
│       │                                      │                             │
│       ▼                                      │                             │
│   特征选择 (101维)                           │                             │
│       │                                      │                             │
│       ▼                                      ▼                             │
│   ┌─────────────────────────────────────────────────────┐                  │
│   │              融合网络 (Fusion Network)               │                  │
│   │  ┌─────────────────────────────────────────────┐    │                  │
│   │  │  • 多头自注意力机制 (8 heads)               │    │                  │
│   │  │  • 多尺度 MLP: [256, 128, 64]               │    │                  │
│   │  │  • 门控机制 (基于注意力)                     │    │                  │
│   │  │  • 层归一化 + Dropout(0.0)                  │    │                  │
│   │  └─────────────────────────────────────────────┘    │                  │
│   │                                                     │                  │
│   │  输出 = ES_retrieved + Delta(EN_input)             │                  │
│   └─────────────────────────────────────────────────────┘                  │
│       │                                                                     │
│       ▼                                                                     │
│   输出: ES_101_fused (西班牙语韵律特征, 101维)                             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 安装

```bash
git clone --recurse-submodules https://github.com/TheGrSun/Interspeech2026-TOPI-RAPM.git
cd Interspeech2026-TOPI-RAPM
pip install -r requirements.txt
```

## 使用方法

```bash
# 训练
python src/train.py --config config/default.yaml

# 评估
python src/evaluate.py --checkpoint checkpoints/best_model.pth

# 生成提交
cd submit
python generate_submission.py
```

## 数据集

从以下地址下载 DRAL 数据集: https://www.cs.utep.edu/nigel/dral/

## 引用

```bibtex
@inproceedings{rapm2026,
  title={检索增强的韵律映射器用于跨语言韵律迁移},
  author={罗晓阳等},
  booktitle={Interspeech 2026},
  year={2026}
}
```

## 许可证

MIT License

## 致谢

- Interspeech 2026 TOPI S2ST Challenge 组织者
- DRAL 数据集创建者
